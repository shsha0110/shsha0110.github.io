---
title: "[Causal Inference] Appendix 02. Direct and Indirect Effects (Part 4)"
description: "Path-Specific Effects"
author: "유성현"
date: "2026-02-04"
categories: [Causal Inference]
format:
  html:
    toc: true
    number-sections: false
    code-fold: show
    math: true
---

# 1. Introduction

인과추론(Causal Inference)에서 가장 흥미롭고도 도전적인 과제 중 하나는 '효과를 분해(Decomposition)'하는 것입니다. [cite_start]우리가 $X$가 $Y$에 미치는 전체 효과(Total Effect)를 알았다면, 그 다음 질문은 자연스럽게 "그 효과가 직접적인 경로로 발생했는가, 아니면 매개변수 $Z$를 거쳐서 발생했는가?"로 이어집니다[cite: 1, 2].

전통적인 방식(Baron & Kenny 등)은 선형 모델에 의존하지만, 현실의 데이터 생성 과정은 비선형적이고 상호작용(Interaction)이 가득합니다. Judea Pearl은 이러한 한계를 극복하기 위해 **경로 특정 효과(Path-Specific Effects, PSE)**라는 일반화된 프레임워크를 제안했습니다. [cite_start]이 글에서는 PDF 자료를 바탕으로 비선형 모델에서도 적용 가능한 직접·간접 효과의 정의와 이를 뒷받침하는 수학적 구조, 그리고 인과적 공리(Axioms)를 깊이 있게 다룹니다[cite: 4, 5].

---

# 2. Path-Specific Effects (PSE)

## 2.1. The Motivation: Beyond Simple Mediation

단순한 매개 모형(Simple Mediation Model)에서는 $X \to Y$ (직접 경로)와 $X \to Z \to Y$ (간접 경로)만이 존재합니다. 하지만 실제 인과 구조는 훨씬 복잡할 수 있습니다. [cite_start]변수 간의 화살표가 얽혀 있는 상황에서 우리가 관심 있는 **특정 경로들의 집합(subset of paths)**만을 분리해내어 그 효과를 추정하고 싶을 때, **Path-Specific Effect** 개념이 필요합니다[cite: 5, 43].

![Figure 1: 기본적인 매개 모형(좌)과 다중 경로가 존재하는 복잡한 모형(우). 왼쪽 그림에서는 효과가 직접 효과와 $Z$를 경유하는 간접 효과로 명확히 나뉘지만, 오른쪽 그림과 같이 $X$에서 $Y$로 가는 경로가 $Z$, $W$ 등 여러 변수를 거치며 복잡하게 얽힌 경우, 특정 경로(굵은 선)만을 분리하여 정의할 필요가 있다.](./images/mediation_complexity.png)

## 2.2. Definition and Formalization

[cite_start]Path-Specific Effect를 정의하기 위해 Pearl은 **변수 고정(Variable fixing)**이 아닌 **경로 스위칭(Path switching)**이라는 개념을 도입했습니다[cite: 62, 63].

### Step 1: Edge-Subgraph의 정의
우선 전체 인과 그래프(Causal Graph)를 $G$라고 합시다. [cite_start]우리가 효과를 분석하고 싶은 경로들로만 이루어진 하위 그래프(Edge-subgraph)를 $g$라고 정의합니다[cite: 44].
[cite_start]이때, 모델의 각 변수 $X_i$에 대해 부모 변수 집합 $PA_i$를 두 부분으로 나눌 수 있습니다[cite: 46, 47]:

$$
PA_i = \{ PA_i(g), PA_i(\bar{g}) \}
$$

* [cite_start]$PA_i(g)$: 그래프 $g$에 포함된 엣지를 통해 $X_i$에 연결된 부모 변수들 (활성화된 경로) [cite: 48]
* [cite_start]$PA_i(\bar{g})$: 그래프 $g$에 포함되지 않은 엣지를 통해 연결된 부모 변수들 (비활성화된 경로) [cite: 48]

### Step 2: Modified Structural Equations
이제 **경로 특정 효과**를 계산하기 위해 구조방정식(Structural Model)을 수정합니다. [cite_start]원래 모델 $M$에서의 구조방정식이 $x_i = f_i(pa_i, u_i)$라면, 수정된 모델 $M_{g}^*$에서의 새로운 함수 $f_i^*$는 다음과 같이 정의됩니다[cite: 49, 50].

$$
f_i^*(pa_i, u; g) = f_i(pa_i(g), pa_i^*(\bar{g}), u)
$$

이 수식의 의미는 매우 직관적입니다:
1.  **관심 있는 경로($g$)**를 통해 들어오는 입력($pa_i(g)$)은 **처치 $X=x$**의 영향을 받아 변하게 둡니다.
2.  [cite_start]**관심 없는 경로($\bar{g}$)**를 통해 들어오는 입력($pa_i^*(\bar{g})$)은 **기준값 $X=x^*$**일 때의 값으로 고정합니다[cite: 51].

[cite_start]즉, $pa_i^*(\bar{g}) = PA_i(\bar{g})_{x^*}$ 입니다[cite: 51].

### Step 3: The g-Specific Effect Definition
[cite_start]최종적으로, 기준값 $x^*$ 대비 처치 $x$가 $Y$에 미치는 **$g$-specific effect**는 수정된 모델 $H_{g}^*$에서의 전체 효과(Total Effect)로 정의됩니다[cite: 52, 53].

$$
SE_{g}(x, x^*; Y, u)_{M} = TE(x, x^*; Y, u)_{M_{g}^*}
$$

[cite_start]이 정의는 비선형 모델이나 상호작용 항이 있는 경우에도 직접 효과와 간접 효과를 일관성 있게 정의할 수 있게 해줍니다[cite: 63].

---

# 3. Nested Counterfactuals: A Visual Interpretation

이 개념을 명확히 이해하기 위해, PDF 자료에 제시된 일명 "Kite Graph" (또는 Diamond Graph) 예시를 살펴봅시다.

![Figure 2: Path-Specific Effect를 설명하기 위한 인과 그래프. $X$가 $W$, $Z$에 영향을 주고, $W$와 $Z$가 서로 상호작용하며 최종적으로 $Y$에 영향을 주는 구조이다. 굵은 화살표는 우리가 효과를 측정하고자 하는 관심 경로(edge-subgraph $g$)를 나타낸다.](./images/kite_graph_structure.png)

위 그림과 같은 구조에서 특정 경로의 효과를 계산하려면, 우리는 가상의 세계(Counterfactual world)를 상상해야 합니다. [cite_start]아래 그림은 $X$가 $x$(녹색)일 때와 $x^*$(적색)일 때의 신호가 어떻게 섞여서 $Y$에 도달하는지를 보여주는 **Counterfactual Graph**입니다[cite: 55].

![Figure 3: 중첩된 반사실적 상황(Nested Counterfactuals)을 표현한 그래프. 녹색 화살표는 처치 값 $x$가 전파되는 경로를, 적색 화살표는 기준 값 $x^*$가 전파되는 경로를 의미한다. $W$ 노드는 $x^*$의 직접적 영향과 $Z_x$(녹색 경로로 온 $Z$)의 영향을 동시에 받으므로 $W_{x^*, Z_x}$로 표기된다. 최종 결과 $Y$는 이러한 혼합된 신호들의 복합적인 결과물이다.](./images/nested_counterfactuals_color.png)

이 그림에서 가장 주목해야 할 점은 **Recanting Witness** 문제와 관련된 복잡한 항입니다:

$$
Y_{W_{x^*, Z_x}, Z_{x^*}}
$$

[cite_start]이 수식을 분해해보면 다음과 같습니다[cite: 59]:
1.  $Z$는 $x$의 영향을 받습니다 ($Z_x$, 녹색 경로).
2.  $W$는 $X$로부터는 $x^*$의 영향을 받지만(적색 경로), $Z$로부터는 $x$의 영향을 받은 값($Z_x$)을 입력받습니다. 즉, $W$는 $W_{x^*, Z_x}$가 됩니다.
3.  최종적으로 $Y$는 $W$로부터는 혼합된 신호를 받고, $Z$로부터는 순수한 $x^*$의 영향($Z_{x^*}$)을 받습니다.

이러한 **중첩된 반사실(Nested Counterfactuals)**의 구조를 이해하는 것은 매개 분석에서 교란 요인을 통제하고 순수한 메커니즘을 식별하는 데 필수적입니다. [cite_start]Pearl은 Markovian 모델에서는 이러한 조건들이 항상 만족되어 추정이 가능함을 보였습니다[cite: 64, 65].

---

# 4. Axioms of Causal Inference

이러한 복잡한 반사실적 조작이 논리적으로 타당하려면, 몇 가지 기본적인 공리(Axioms)가 성립해야 합니다. [cite_start]PDF의 Appendix 부분에서는 다음 세 가지 핵심 성질을 제시합니다[cite: 68, 73, 76].

## 4.1. Composition (합성)
어떤 변수 $W$를 강제로 $w$라는 값으로 고정했다고 가정합시다. [cite_start]만약 우리가 $X$에 개입했을 때 $W$가 자연스럽게 갖게 될 값이 이미 $w$라면, $W$를 $w$로 강제하는 개입은 $Y$에 아무런 추가적인 영향을 주지 않는다는 원칙입니다[cite: 69, 70, 71].

$$
W_x(u) = w \implies Y_{xw}(u) = Y_x(u)
$$

즉, "이미 발생할 일이었다면, 강제로 시켜도 결과는 같다"는 뜻입니다.

## 4.2. Consistency (일치성)
가장 기본적이면서도 중요한 가정입니다. [cite_start]만약 관측된 데이터에서 $X=x$라면, 그때 관측된 $Y$는 $X$를 $x$로 강제했을 때의 잠재적 결과 $Y_x$와 같아야 합니다[cite: 74].

$$
X(u) = x \implies Y(u) = Y_x(u)
$$

## 4.3. Effectiveness and Reversibility
* [cite_start]**Effectiveness (유효성):** 변수 $X$와 $W$를 각각 $x, w$로 고정하면, $X$의 값은 확실히 $x$가 됩니다[cite: 77].
    $$X_{xw}(u) = x$$
* [cite_start]**Reversibility (가역성):** 만약 $X$를 고정했을 때 $Y, W$가 각각 $y, w$가 되고, 이 상태들이 서로 모순되지 않는다면 원래의 효과 $Y_x$는 $y$로 유지됩니다[cite: 78].
    $$(Y_{xw}(u) = y) \land (W_{xy}(u) = w) \implies Y_x(u) = y$$

---

# 5. Conclusion

Pearl의 **Path-Specific Effects** 프레임워크는 단순히 변수를 통제하는 것을 넘어, 인과 경로를 정밀하게 수술(surgery)하듯 분리해내는 강력한 도구입니다.

1.  [cite_start]**비선형성 해결:** 선형 가정 없이도 직접/간접 효과를 정의할 수 있습니다[cite: 63].
2.  [cite_start]**조작적 해석:** 간접 효과에 대한 명확한 조작적(operational) 해석을 제공합니다[cite: 66].
3.  [cite_start]**일반화:** Markovian 모델 등 특정 조건 하에서, 실험 데이터나 관측 데이터로부터 이러한 효과를 일관되게 추정할 수 있습니다[cite: 64, 65].

이러한 이론적 토대는 복잡한 사회 현상이나 생물학적 메커니즘을 규명하는 데 있어 단순 회귀분석이 줄 수 없는 깊은 통찰을 제공합니다.

---

### Verification Checklist

* **내용 포함 여부:**
    * [x] Path-Specific Effects의 정의 및 $SE_g$ 수식 (PDF p.5)
    * [x] Edge-subgraph 및 부모 변수 파티션 $PA_i(g)$ (PDF p.5)
    * [x] 수정된 구조방정식 $f_i^*$ (PDF p.5)
    * [x] Nested Counterfactuals 및 Kite Graph 설명 (PDF p.4, 6)
    * [x] Axioms (Composition, Consistency, Effectiveness, Reversibility) (PDF p.8-10)
* **생략된 내용:**
    * 없음. PDF의 Overview부터 Appendix의 Axiom까지 모든 핵심 슬라이드 내용을 서술적으로 재구성함.