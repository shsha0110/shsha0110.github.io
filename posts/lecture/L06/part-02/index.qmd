---
title: "[Causal Inference] 06. The Causal Calculus (Part 2)"
description: "Identification Approaches & Three Insights"
author: "유성현"
date: "2026-01-23"
categories: [Causal Inference]
format:
  html:
    toc: true
    number-sections: false
    code-fold: show
    math: true
---

# 1. Introduction

이전 포스트들에서 우리는 Back-door와 Front-door 기준을 통해 특정 그래프 구조에서 인과 효과를 식별하는 방법을 배웠습니다. 하지만 모든 인과 모형이 이러한 표준적인 형태를 띠는 것은 아닙니다. 더욱 복잡한 그래프 구조에서 인과 효과 $P(y|do(x))$를 식별하기 위해서는 보다 일반화된 규칙이 필요합니다.

이번 포스트에서는 Judea Pearl의 **Do-Calculus**가 등장하게 된 배경과, 이를 구성하는 세 가지 핵심 통찰(Three Insights)에 대해 다룹니다. [cite_start]이는 인과적 질문(Query)을 관측 가능한 통계적 추정량(Estimand)으로 변환하는 체계적인(Systematic) 접근법의 기초가 됩니다[cite: 147].

# 2. The Syntactical Goal on Identification

## 2.1. The Problem Definition
Back-door와 Front-door 설정 모두에서 우리의 목표는 하나였습니다. [cite_start]바로 개입(Intervention)에 의한 확률 분포 $Q = P(y|do(x))$를 관측 데이터의 분포 $P(v)$만으로 계산 가능한 식(expression)으로 환원(reduce)하는 것입니다[cite: 152, 160].

## 2.2. Two Approaches
이 목표를 달성하기 위한 방법은 크게 두 가지로 나뉩니다.

1.  **Algebraic Approach (Truncated Factorization):**
    [cite_start]구조적 인과 모델(SCM)의 Truncated Factorization 공식을 사용하여, 잠재 변수 $U$가 포함되지 않은(U-free) 표현식을 유도하는 방법입니다[cite: 156, 161]. 이는 앞서 Back-door/Front-door 공식을 유도할 때 사용했던 방식입니다.

2.  **Axiomatic Approach (Do-Calculus):**
    [cite_start]잠재 변수 $U$를 직접 다루거나 매번 적분을 수행하는 대신, $do(\cdot)$ 연산자를 포함한 식을 $do(\cdot)$가 없는 식(do-free expression)으로 변환하는 **일련의 규칙(rules) 또는 공리(axioms)**를 사용하는 방법입니다[cite: 157, 162].

[cite_start]우리는 이 두 번째 접근법, 즉 타겟 효과(Target Effect)와의 등가성을 유지하면서 $do$ 표현식을 체계적으로 변환할 수 있는 규칙에 관심을 가질 것입니다[cite: 163].

# 3. Prelude: Conditional Independence in Submodels

본격적인 규칙을 다루기 전에, 개입 $do(X=x)$가 가해진 세상에서의 조건부 독립성이 그래프 상에서 어떻게 표현되는지 정의해야 합니다.

## 3.1. Submodel $\mathcal{H}_x$ and Graph $\mathcal{G}_{\overline{X}}$
[cite_start]$do(X=x)$라는 행위는 모델 내에서 $X$를 결정하는 구조적 함수 $f_X$를 상수 $x$로 대체하는 것을 의미합니다[cite: 189, 201].
$$
X \leftarrow x
$$
[cite_start]이를 그래프 관점에서 보면, 변수 $X$가 더 이상 다른 변수(부모 변수)들의 영향을 받지 않음을 의미합니다[cite: 196, 202]. 따라서 원래 그래프 $\mathcal{G}$에서 **$X$로 들어오는 모든 화살표(incoming edges)를 제거**한 그래프를 생각할 수 있으며, 이를 $\mathcal{G}_{\overline{X}}$라고 표기합니다.

![Figure 1: Submodel Graph $\mathcal{G}_{\overline{X}}$. 점선 화살표는 원래 그래프 $\mathcal{G}$에는 존재했으나, 개입 $do(X)$로 인해 $X$가 상수로 고정되면서 제거된 경로를 나타냅니다. $X$는 이제 외부 변수의 영향을 받지 않는 고립된 노드(부모가 없는 노드)처럼 행동합니다.](./images/submodel_graph_Gx_bar.png)

## 3.2. Independence Condition
개입된 세상 $\mathcal{H}_x$에서의 조건부 독립성은 그래프 $\mathcal{G}_{\overline{X}}$에서의 d-separation으로 해석할 수 있습니다. [cite_start]특히, $X$는 이제 상수 $x$로 고정되었으므로, 이는 $\mathcal{G}_{\overline{X}}$에서 $X=x$로 조건부(conditioning)를 건 것과 유사하게 동작합니다[cite: 203, 219].

[cite_start]따라서, $do(x)$ 하에서의 조건부 독립성 $(A \perp\!\!\!\perp B | C)$는 $\mathcal{G}_{\overline{X}}$ 그래프상에서의 분리(separation)와 동치입니다[cite: 220, 221].

# 4. Three Insights for Identification

Do-Calculus의 세 가지 규칙은 다음의 세 가지 직관적인 상황(Insights)에서 유도됩니다.

## 4.1. Insight 1: Adding/Removing Observations
첫 번째 통찰은 **"언제 관측 변수 $Z$를 무시해도 되는가?"**에 대한 것입니다.

[cite_start]원래 모델에서는 $Z$와 $Y$가 서로 연관되어 있어 분리할 수 없다고 가정해 봅시다(예: $Z \not\perp\!\!\!\perp Y | X$)[cite: 226]. [cite_start]하지만 $X$에 개입을 가한 $do(X)$ 세상(즉, $\mathcal{G}_{\overline{X}}$)에서 $Y$와 $Z$가 $X$에 의해 d-separated 된다면, $Z$를 관측하는 것은 $Y$의 확률 분포에 아무런 추가 정보를 주지 않습니다[cite: 228, 229].

### The Rule
$$
(Y \perp\!\!\!\perp Z | X)_{\mathcal{G}_{\overline{X}}} \implies P(y|do(x), z) = P(y|do(x))
$$
즉, 개입된 그래프 $\mathcal{G}_{\overline{X}}$에서 조건부 독립이 성립하면, $do(x)$ 식에서 조건절의 $z$를 제거할 수 있습니다.

![Figure 2: Insight 1 Graph Structure. $X$에 개입하여 $X$로 들어오는 화살표가 제거된 상황($\mathcal{G}_{\overline{X}}$)입니다. 이 그래프에서 $X$가 주어졌을 때 $Z$와 $Y$ 사이의 모든 경로가 차단된다면(d-separated), $Z$는 $Y$에 대한 추가적인 정보를 제공하지 않습니다.](./images/insight1_graph.png)

### Derivation
Truncated Factorization을 이용해 이를 증명할 수 있습니다.
개입 분포 $P(y,z|do(x))$는 다음과 같이 주어집니다.
$$
P(y,z|do(x)) = \sum_{u} P(z|u_z) P(y|x, u_y, u') P(u) = P(z) \sum_{u'} P(y|x, u') P(u')
$$
[cite_start][cite: 240]

이때 조건부 확률의 정의에 따라:
$$
P(y|do(x), z) = \frac{P(y,z|do(x))}{P(z|do(x))}
$$
[cite_start]분모인 $P(z|do(x))$를 계산해보면 $P(z)$가 나옵니다(모든 $y$에 대해 합을 취함)[cite: 252].
$$
P(z|do(x)) = \sum_{y} P(z) \sum_{u'} P(y|x, u') P(u') = P(z) \cdot 1 = P(z)
$$
[cite_start]따라서 분자와 분모의 $P(z)$가 약분되어 다음을 얻습니다[cite: 263].
$$
P(y|do(x), z) = \sum_{u'} P(y|x, u') P(u') = P(y|do(x))
$$

## 4.2. Insight 2: Action/Observation Exchange
두 번째 통찰은 **"언제 개입(Action)을 단순 관측(Observation)으로 바꿀 수 있는가?"**입니다. [cite_start]이는 Back-door 기준의 핵심 논리와 맞닿아 있습니다[cite: 273, 286].

[cite_start]만약 $Z$를 관측한 상태에서, $X$가 $Y$에 미치는 영향이 오직 인과적 경로(causal paths)를 통해서만 전달되고 교란 요인(confounders)에 의한 영향이 없다면, $see(X=x)$는 $do(X=x)$와 동일한 효과를 갖습니다[cite: 284, 285].

### The Rule
[cite_start]이 조건은 그래프 $\mathcal{G}_{\underline{X}}$ (X에서 **나가는** 화살표를 제거한 그래프)에서 확인합니다[cite: 288, 308].
$$
(Y \perp\!\!\!\perp X | Z)_{\mathcal{G}_{\underline{X}}} \implies P(y|do(x), z) = P(y|x, z)
$$
[cite_start]이것이 성립하면 $do(x)$를 일반 조건부 확률 $x$로 바꿀 수 있습니다 (Exchange of Action & Observation)[cite: 294, 295].

![Figure 3: Insight 2 Graph Structure ($\mathcal{G}_{\underline{X}}$). $X$에서 $Y$로 가는 직접적인 인과 경로(outgoing edge)를 제거한 그래프입니다. 이 상태에서 $Z$를 조건부로 했을 때 $X$와 $Y$가 독립이라면(d-separated), $X$와 $Y$ 사이의 Back-door path가 모두 차단된 것입니다.](./images/insight2_graph_Gx_under.png)

### Derivation
Back-door adjustment가 성립하는 구조($Z$가 Back-door path를 차단)를 가정합니다.
$$
P(y, z|do(x)) = \sum_{u} P(z|u_z) P(y|x, z, u_y) P(u) = P(z) P(y|x, z)
$$
[cite_start][cite: 297]
[cite_start]마찬가지로 $P(z|do(x)) = P(z)$입니다[cite: 305, 306].
따라서 비율을 계산하면:
$$
P(y|do(x), z) = \frac{P(z)P(y|x, z)}{P(z)} = P(y|x, z)
$$
[cite_start][cite: 307].

## 4.3. Insight 3: Adding/Removing Actions
세 번째 통찰은 **"언제 개입(Action) 자체가 결과에 아무런 영향을 주지 않아 무시할 수 있는가?"**입니다.

[cite_start]매우 직관적인 사실은, 만약 $X$에서 $Z$로 가는 인과적 경로(causal path)가 전혀 없다면, $X$에 어떤 개입을 하더라도 $Z$의 분포는 변하지 않는다는 것입니다[cite: 311].

### The Rule
$$
(Z \perp\!\!\!\perp X)_{\mathcal{G}_{\overline{X}}} \implies P(z|do(x)) = P(z)
$$
[cite_start]개입된 그래프 $\mathcal{G}_{\overline{X}}$에서 $X$와 $Z$가 독립이라면(즉, 연결된 경로가 없다면), $do(x)$라는 행위 자체를 식에서 제거할 수 있습니다[cite: 319, 321].

![Figure 4: Insight 3 Graph Structure. $X$와 $Z$ 사이에 인과적 연결이 없는 상황을 묘사합니다. $\mathcal{G}_{\overline{X}}$에서 $X$에서 $Z$로 가는 경로가 없다면, $X$에 대한 조작은 $Z$의 분포에 영향을 미치지 않습니다.](./images/insight3_graph.png)

### Derivation
개입 분포 $P(z|do(x))$를 주변화(marginalization)를 통해 전개하면:
$$
P(z|do(x)) = \sum_{y} \sum_{u} P(z|u_{zy}, u_{zx}) P(y|x, u_{zy}) P(u)
$$
[cite_start]여기서 $Z$의 결정 식에는 $x$가 관여하지 않으므로, $u$에 대한 합을 정리하면 $P(z)$가 그대로 유도됩니다[cite: 332].
$$
= \sum_{u} P(z|u) P(u) = P(z)
$$
(상세 유도 과정에서 $y$와 관련된 항들은 합쳐져서 1이 됩니다).

# 5. Summary

이번 포스트에서는 복잡한 인과 효과 식별 문제를 풀기 위한 기초 작업으로 세 가지 통찰을 살펴보았습니다.

1.  **Observation Removal:** $\mathcal{G}_{\overline{X}}$에서 조건부 독립이면, 관측값 $z$를 조건절에서 제거 가능.
2.  **Action to Observation:** $\mathcal{G}_{\underline{X}}$에서 조건부 독립이면, $do(x)$를 $x$로 변환 가능.
3.  **Action Removal:** $\mathcal{G}_{\overline{X}}$에서 독립이면, $do(x)$ 자체를 제거 가능.

이 세 가지 통찰은 다음 포스트에서 다룰 **Do-Calculus의 3가지 공식 규칙(The 3 Rules of Do-Calculus)**으로 정식화됩니다. 이 규칙들은 인과 추론의 "미분 적분학"과 같은 역할을 하여, 그래프 구조만 주어진다면 어떤 복잡한 인과 효과도 식별 가능한지 판별하고 계산할 수 있게 해줍니다.

---

### 누락 방지 검증 체크리스트

* **포함된 내용:**
    * [cite_start][x] 식별(Identification)의 구문론적 목표 (Syntactical Goal) 및 두 가지 접근법 (Algebraic vs Axiomatic) [cite: 151, 156, 163]
    * [cite_start][x] Submodel $\mathcal{H}_x$와 그래프 $\mathcal{G}_{\overline{X}}$의 정의 및 조건부 독립성의 의미 [cite: 188, 196, 220]
    * [cite_start][x] **Insight 1:** Adding/Removing Observations의 조건, 규칙, 유도 과정 [cite: 229, 240, 263]
    * [cite_start][x] **Insight 2:** Action/Observation Exchange의 조건, 규칙($\mathcal{G}_{\underline{X}}$ 사용), 유도 과정 [cite: 287, 297, 307]
    * [cite_start][x] **Insight 3:** Adding/Removing Actions의 조건, 규칙, 유도 과정 [cite: 319, 332]
    * [x] 각 개념에 대응하는 Markdown 이미지 Placeholder 및 상세 캡션

* **생략된 내용:**
    * 없음. 제공된 PDF 범위(Slide 6 ~ 12) 내의 모든 핵심 이론과 수식 유도를 포함함.