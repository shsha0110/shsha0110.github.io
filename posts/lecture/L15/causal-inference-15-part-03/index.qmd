---
title: "비교 불가능을 비교하다: 합성 대조조법 (Synthetic Control Method)"
author: "유성현"
date: "2026-01-23"
categories: [Causal Inference, Econometrics, Methodology, SCM]
format:
  html:
    toc: true
    number-sections: true
    code-fold: true
    math: true
---

## 들어가며: 적절한 비교 대상이 없다면?

지난 포스트들에서 우리는 이중차분법(DiD)을 통해 정책의 효과를 추정하는 방법을 배웠습니다. 하지만 DiD를 적용하기 어려운 상황이 종종 발생합니다. 바로 **"적절한 통제 집단(Control Group)을 찾기 어려울 때"**입니다.

예를 들어, 캘리포니아 주가 담배 규제 정책(Proposition 99)을 시행했을 때, 나머지 49개 주 전체를 평균 내어 비교하는 것이 공정할까요? 캘리포니아와 인구 구조, 경제 규모, 흡연 문화가 비슷한 단일한 주는 존재하지 않을지도 모릅니다.

이번 포스트에서는 이러한 문제를 해결하기 위해, 여러 통제 집단을 적절히 섞어 **"가상의 도플갱어(Synthetic Control)"**를 만들어내는 **합성 대조조법(Synthetic Control Method, SCM)**에 대해 알아봅니다.

> **참고 자료**: 본 포스트는 이상학 교수님의 "Differences in Differences & Synthetic Control Method" 강의 자료(1503 DiD SCM.pdf)를 바탕으로 재구성되었습니다.

---

## 1. 사례 연구: 캘리포니아 담배 규제 (Proposition 99)

1988년 캘리포니아 주는 담배 소비를 줄이기 위해 담배세를 인상하는 'Proposition 99'를 통과시켰습니다. 이 정책의 효과를 어떻게 측정할 수 있을까요?

### 1.1 단순 비교의 함정
가장 단순한 방법은 "캘리포니아"와 "나머지 미국 전체(Rest of the U.S.)"의 담배 판매량을 비교하는 것입니다.

!(path/to/scm_bad_control.png)
*주석: 점선(Rest of the U.S.)은 캘리포니아(실선)와 정책 시행 이전(1988년 이전)부터 추세가 다릅니다. 이는 평행 추세 가정을 위배하며, 좋은 비교 대상이 아님을 보여줍니다.*

### 1.2 합성 캘리포니아 (Synthetic California)의 등장
SCM은 다른 주들의 데이터를 가중 평균(Weighted Average)하여, 1988년 이전의 캘리포니아와 **거의 완벽하게 겹치는** 가상의 캘리포니아를 만들어냅니다.

!(path/to/scm_good_control.png)
*주석: 합성 캘리포니아(점선)는 정책 시행 이전까지 실제 캘리포니아(실선)와 거의 일치합니다. 따라서 1988년 이후 벌어지는 격차(Gap)를 순수한 정책 효과로 해석할 수 있습니다.*

---

## 2. 수학적 모형 (Mathematical Framework)

SCM을 수식으로 엄밀하게 정의해 봅시다.

### 2.1 기본 세팅
* **단일 처치 집단:** $i=1$ (캘리포니아)
* **통제 집단 풀(Donor Pool):** $i=2, \dots, J+1$ (나머지 주들)
* **시간:** $T_0$ (개입 이전 기간), $T$ (전체 기간)
* **목표:** 개입 이후($t > T_0$)의 처치 효과 $\tau_{1t}$ 추정
  $$\tau_{1t} = Y_{1t}(1) - Y_{1t}(0)$$

여기서 $Y_{1t}(1)$은 관찰되지만, 정책이 없었을 때의 결과인 $Y_{1t}(0)$은 **결측된 반사실(Missing Counterfactual)**입니다.

### 2.2 합성 통제 집단 구성 (Weights Construction)
SCM의 핵심은 통제 집단 유닛들에 부여할 **가중치 벡터 $W = (w_2, \dots, w_{J+1})'$**를 찾는 것입니다. 이 가중치는 다음 두 가지 제약 조건을 만족해야 합니다.

1.  **비음수 조건 (Non-negative):** $w_j \ge 0$
2.  **합의 조건 (Sum to one):** $\sum_{j=2}^{J+1} w_j = 1$

이 제약 조건들은 합성 통제 집단이 데이터들의 **볼록 껍질(Convex Hull)** 내부에 존재하게 하여, **내삽(Interpolation)**을 수행하도록 강제합니다. 즉, 데이터의 범위를 벗어나는 과도한 **외삽(Extrapolation)**을 방지합니다.

### 2.3 최적화 문제 (Optimization)
우리는 개입 이전 기간($t \le T_0$) 동안 처치 집단($Y_1$)과 합성 통제 집단($\sum w_j Y_j$)의 차이를 최소화하는 $W^*$를 찾습니다.

$$
W^* = \underset{W}{\mathrm{argmin}} \left( \sum_{t=1}^{T_0} (Y_{1t} - \sum_{j=2}^{J+1} w_j Y_{jt})^2 + \sum_{k=1}^{K} (Z_{1k} - \sum_{j=2}^{J+1} w_j Z_{jk})^2 \right)
$$
*(실제로는 각 변수의 중요도를 반영하는 $V$ 행렬을 포함한 2중 최적화가 수행되지만, 직관적 이해를 위해 단순화했습니다.)*

---

## 3. 이론적 정당성 (Theoretical Justification)

왜 SCM이 DiD보다 강력할 수 있을까요? 이는 **요인 모형(Factor Model)**을 통해 설명됩니다.

### 3.1 상호작용 요인 모형 (Interacted Factor Model)
결과 변수 $Y_{it}(0)$가 다음과 같이 생성된다고 가정해 봅시다.

$$
Y_{it}(0) = \delta_t + \boldsymbol{Z}_i' \boldsymbol{\beta}_t + \boldsymbol{\lambda}_t \boldsymbol{\mu}_i + \epsilon_{it}
$$

* $\delta_t$: 시간 고정 효과 (Time Fixed Effect)
* $\boldsymbol{Z}_i$: 관찰 가능한 공변량
* **$\boldsymbol{\lambda}_t \boldsymbol{\mu}_i$**: 관찰되지 않은 **시간 가변적 교란 요인(Time-varying Confounding)**

기존의 DiD는 시간 불변의 고정 효과($\alpha_i$)만 제거할 수 있지만, SCM은 적절한 가중치 구성을 통해 $\boldsymbol{\lambda}_t \boldsymbol{\mu}_i$ 항까지 상쇄시킬 수 있습니다. Abadie et al. (2010)은 개입 이전 기간($T_0$)이 충분히 길다면, SCM 추정량의 편향(Bias)이 0으로 수렴함을 증명했습니다.

### 3.2 볼록성(Convexity)의 기하학적 의미
SCM은 데이터를 '섞어서' 만드는 것이므로 기하학적으로는 다면체 내부의 한 점을 찾는 것과 같습니다.

!(path/to/convex_hull_triangle.png)
*주석: $X_1$(검은 점)을 $X_0$(빨간 점들)의 조합으로 표현할 때, $X_1$이 빨간 점들이 이루는 다면체(Triangle) 내부에 있어야 안전한 추론(Interpolation)이 가능합니다. 외부에 있다면 SCM 적용에 주의가 필요합니다.*

---

## 4. 한계와 확장: Augmented SCM

### 4.1 편향 보정 (Bias Correction)
현실에서는 개입 이전 기간($T_0$)에도 처치 집단과 합성 대조군이 완벽하게 일치하지 않을 수 있습니다(Imperfect Pre-treatment Fit). 이 경우 추정치에 편향이 발생합니다.

이를 해결하기 위해 **Augmented SCM (ASCM)**이 제안되었습니다.

### 4.2 ASCM 공식
ASCM은 기존 SCM 추정치에 **회귀분석을 이용한 보정항**을 추가합니다.

$$
\hat{Y}_{1t}^{aug}(0) = \underbrace{\sum_{j=2}^{J+1} w_j Y_{jt}}_{\text{Original SCM}} + \underbrace{\left( \hat{m}_{1t} - \sum_{j=2}^{J+1} w_j \hat{m}_{jt} \right)}_{\text{Bias Correction}}
$$

* $\hat{m}_{it}$: 공변량 등을 이용해 예측한 결과값 (Ridge Regression 등을 사용)
* 이 보정항은 합성 대조군이 설명하지 못하는 잔여 차이를 회귀 모델로 메꿔주는 역할을 합니다.

---

## 마치며: 투명하고 강력한 인과추론

합성 대조조법은 다음과 같은 이유로 현대 사회과학 연구에서 가장 사랑받는 방법론 중 하나가 되었습니다.

1.  **투명성 (Transparency):** 어떤 통제 유닛이 몇 퍼센트의 비중으로 사용되었는지 명확히 알 수 있습니다.
2.  **데이터 기반 (Data-driven):** 연구자의 자의적인 대조군 선정을 방지합니다.
3.  **유연성:** 시간에 따라 변하는 교란 요인을 통제할 수 있습니다.

데이터가 충분히 쌓인 시계열 환경에서 정책 효과를 분석해야 한다면, SCM은 가장 먼저 고려해야 할 도구입니다.